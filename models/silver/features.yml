version: 2

models:
  - name: feat_h3_pop_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: cell_wkt_4326
        tests:
          - not_null
          - wkt_not_empty:
              column_name: cell_wkt_4326
          - wkt_prefix_any:
              column_name: cell_wkt_4326
              prefixes: ["POLYGON", "MULTIPOLYGON"]
      - name: cell_center_wkt_4326
        tests:
          - not_null
          - wkt_not_empty:
              column_name: cell_center_wkt_4326
          - wkt_prefix_any:
              column_name: cell_center_wkt_4326
              prefixes: ["POINT"]
      - name: pop_total
        tests:
          - non_negative:
              column_name: pop_total
      - name: share_emp
        tests:
          - num_between_or_null:
              column_name: share_emp
              min_value: 0
              max_value: 1
              config:
                name: feat_h3_pop_r10__share_emp_0_1
                severity: warn
                warn_if: "> 0"
                error_if: ">= 1000"

  - name: feat_h3_ev_chargers_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: chargers_cnt
        tests:
          - non_negative:
              column_name: chargers_cnt

  - name: feat_h3_roads_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: region
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: roads_len_m_sum
        tests:
          - non_negative:
              column_name: roads_len_m_sum

  - name: feat_h3_poi_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: poi_cnt
        tests:
          - non_negative:
              column_name: poi_cnt

  - name: feat_h3_transit_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: transit_points_cnt
        tests:
          - non_negative:
              column_name: transit_points_cnt
      - name: transit_lines_len_m_sum
        tests:
          - non_negative:
              column_name: transit_lines_len_m_sum

  - name: feat_h3_activity_places_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: places_cnt
        tests:
          - non_negative:
              column_name: places_cnt

  - name: feat_h3_degurba_r10
    tests:
      - rowcount_gt_0
    columns:
      - name: region_code
        tests: [not_null]
      - name: h3_r10
        tests: [not_null, is_h3_hex]
      - name: year
        tests: [not_null]