version: 2

models:
  - name: dim_h3_r7_cells
    description: >
      H3 R7 dimension for all referenced cells across SILVER entities.
      Stores boundary + center (GEOMETRY + WKT debug) and cell area in mÂ² (EPSG:3035).

    tests:
      - rowcount_gt_0:
          config:
            name: dim_h3_r7_cells__rowcount_gt_0

      - unique_combination_of_columns:
          columns: [region_code, region, h3_r7]
          config:
            name: dim_h3_r7_cells__uk_region_region_h3

    columns:
      - name: region_code
        description: Region scope identifier (project-level).
        tests: [not_null]

      - name: region
        description: Region human-readable name (project-level).
        tests: [not_null]

      - name: h3_r7
        description: H3 index (resolution 7) as string.
        tests:
          - not_null
          - is_h3_hex:
              arguments:
                column_name: h3_r7
              config:
                name: dim_h3_r7_cells__h3_r7_is_h3

      - name: cell_wkt_4326
        description: Cell boundary WKT (EPSG:4326).
        tests:
          - not_null
          - wkt_not_empty:
              arguments: { column_name: cell_wkt_4326 }
              config: { name: dim_h3_r7_cells__cell_wkt_not_empty }
          - wkt_prefix_any:
              arguments:
                column_name: cell_wkt_4326
                prefixes: ["POLYGON", "MULTIPOLYGON"]
              config:
                name: dim_h3_r7_cells__cell_wkt_prefix_polygonal

      - name: cell_center_wkt_4326
        description: Cell center point WKT (EPSG:4326).
        tests:
          - not_null
          - wkt_not_empty:
              arguments: { column_name: cell_center_wkt_4326 }
              config: { name: dim_h3_r7_cells__center_wkt_not_empty }
          - wkt_prefix_any:
              arguments:
                column_name: cell_center_wkt_4326
                prefixes: ["POINT"]
              config:
                name: dim_h3_r7_cells__center_wkt_prefix_point

      - name: cell_area_m2
        description: Cell area in square meters (computed in EPSG:3035).
        tests:
          - non_negative:
              arguments: { column_name: cell_area_m2 }
              config: { name: dim_h3_r7_cells__cell_area_non_negative }